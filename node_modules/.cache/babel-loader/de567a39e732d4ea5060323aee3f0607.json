{"ast":null,"code":"import _slicedToArray from\"/Users/irene/Desktop/ABCgame/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/irene/Desktop/ABCgame/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import*as React from\"react\";//XState library & Game DM-machine\nimport{Machine,assign,send}from\"xstate\";import{useMachine,asEffect}from\"@xstate/react\";import{dmMachine}from'./dmGame';//Animation effects\nimport Confetti from'react-dom-confetti';import TextLoop from\"react-text-loop\";import{useWindupString}from\"windups\";// import HeadShake from 'react-reveal/HeadShake';\nvar HeadShake=require('react-reveal/HeadShake');//?import shows error in TS, so use require() here instead\nvar RubberBand=require('react-reveal/RubberBand');import Tippy from'@tippyjs/react';// import 'tippy.js/dist/tippy.css'; \n//Browser detection \nimport{isChrome,isEdge}from\"react-device-detect\";// import { inspect } from \"@xstate/inspect\";\n// inspect({ url:\"https://statecharts.io/inspect\", iframe: false });\n// State machines: ASR-TTS (voice interface) & dmGame\nimport{useSpeechSynthesis,useSpeechRecognition}from'react-speech-kit';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var machine=Machine({id:'root',type:'parallel',states:{dm:_objectSpread({},dmMachine),asrtts:{initial:'idle',states:{idle:{on:{LISTEN:'recognising',SPEAK:{target:'speaking',actions:assign(function(_context,event){return{ttsAgenda:event.value};})}}},recognising:{initial:'progress',entry:'recStart',exit:'recStop',on:{ASRRESULT:{actions:['recLogResult',assign(function(_context,event){return{recResult:event.value};})],target:'.match'},RECOGNISED:'idle'},states:{progress:{},match:{entry:send('RECOGNISED')}}},speaking:{entry:'ttsStart',on:{ENDSPEECH:'idle'}}}}}},{actions:{recLogResult:function recLogResult(context){/* context.recResult = event.recResult; */console.log('<< ASR: '+context.recResult);},test:function test(){console.log('test');},logIntent:function logIntent(context){/* context.nluData = event.data */console.log('<< NLU intent: '+context.nluData.intent.name);}}});//COMPONENT: Big button in the middle, with changing texts\nvar ReactiveButton=function ReactiveButton(props){var playingNow=props.state.context.playingNow;var ttsAgenda=props.state.context.ttsAgenda;var maxHinted=props.state.context.hinted>=5;var maxSkipped=props.state.context.skipped>=5;var promptInGame;if(maxSkipped&&maxHinted){promptInGame='...or say Restart, Stop';}else if(maxSkipped&&!maxHinted){promptInGame='...or say Clue, Restart, Stop';}else if(!maxSkipped&&maxHinted){promptInGame='...or say Skip, Restart, Stop';}else{promptInGame='...or say Clue, Skip, Restart, Stop';}//default\nvar speakingText=playingNow?'üòº '+ttsAgenda:'üòª '+ttsAgenda;var promptMsg=playingNow?promptInGame:\"...say Yes or No\";switch(true){case props.state.matches({asrtts:'recognising'}):return/*#__PURE__*/_jsx(\"button\",_objectSpread(_objectSpread({type:\"button\",className:\"glow-on-hover\",style:{animation:\"glowing 20s linear\"}},props),{},{children:/*#__PURE__*/_jsxs(TextLoop,{mask:true,interval:5000,springConfig:{stiffness:170,damping:8},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"code\",{children:[\" \",speakingText,\" \"]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"code\",{children:[\" \",promptMsg,\" \"]})})]})}));case props.state.matches({asrtts:'speaking'}):var _useWindupString=useWindupString(speakingText),_useWindupString2=_slicedToArray(_useWindupString,1),spokentext=_useWindupString2[0];// adds char-by-char animation\nreturn/*#__PURE__*/_jsx(\"button\",_objectSpread(_objectSpread({type:\"button\",className:\"glow-on-hover\",style:{animation:\"bordering 1s infinite\"}},props),{},{children:/*#__PURE__*/_jsx(\"code\",{children:spokentext})}));default:return/*#__PURE__*/_jsx(\"button\",_objectSpread(_objectSpread({type:\"button\",className:\"glow-on-hover\"},props),{},{children:/*#__PURE__*/_jsx(HeadShake,{children:\"Play game!\"})}));}};// //MAIN CONTAINER: React webpage elements & VOI\nexport default function App(){//Voice interface events (& console logs)\n//Text to speech:\nvar _useSpeechSynthesis=useSpeechSynthesis({onEnd:function onEnd(){send('ENDSPEECH');}}),speak=_useSpeechSynthesis.speak,cancel=_useSpeechSynthesis.cancel,speaking=_useSpeechSynthesis.speaking,voices=_useSpeechSynthesis.voices;//Speech to text\nvar _useSpeechRecognition=useSpeechRecognition({onResult:function onResult(result){send({type:\"ASRRESULT\",value:result});}}),listen=_useSpeechRecognition.listen,listening=_useSpeechRecognition.listening,stop=_useSpeechRecognition.stop;//List the supported synthesis-voices on the browswer:\nvar _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),voiceIndex=_React$useState2[0],setVoiceIndex=_React$useState2[1];// console.log(voices) //An array of available voices/languages ... varies depending on the computer/browser\n// const voice =  voices[5] || null; // voices[idx]? voices[idx] : null *(browser default voice)\nvar _useMachine=useMachine(machine,{devTools:true,actions:{recStart:asEffect(function(){console.log('Ready to receive a voice input.');listen({interimResults:false,continuous:true,lang:'en-SG'//Config recognition language here. //list of langs https://cloud.google.com/speech-to-text/docs/languages\n});}),recStop:asEffect(function(){console.log('Recognition stopped.');stop();}),ttsStart:asEffect(function(context,effect){console.log('Speaking...');speak({text:context.ttsAgenda/*, voice*/ //Config which language/voice to speak in\n});}),ttsCancel:asEffect(function(context,effect){console.log('TTS STOP...');cancel();}),speak:asEffect(function(context){console.log('Speaking...');speak({text:context.ttsAgenda});})}}),_useMachine2=_slicedToArray(_useMachine,3),current=_useMachine2[0],send=_useMachine2[1],service=_useMachine2[2];// dmMachine-context / React-states, to display on webpage or turn components on/off\nvar confettiSwitch=current.context.confettiSwitch;//triggers confetti when true\nvar playingNow=current.context.playingNow;var tally=current.context.tally;var letter=current.context.letter;// Config for confetti \nvar confettiConfig={angle:90,spread:360,startVelocity:80,elementCount:400,dragFriction:0.12,duration:7500,stagger:1,width:\"7px\",height:\"7px\",perspective:\"210px\",colors:[\"#a864fd\",\"#29cdff\",\"#78ff44\",\"#ff718d\",\"#fdff6a\"]};var clicked=0;var handleClick=function handleClick(){if(clicked===0){console.log(\"clicked\");send('CLICK');clicked=1;}else{console.log(\"unclicked\");send('UNCLICK');clicked=0;}};//>>>JSX codes & various components\n// Alt page: Show if not using Chrome or Edge\nif(!isChrome&&!isEdge)return/*#__PURE__*/_jsx(\"div\",{className:\"OtherBrowsers\",children:/*#__PURE__*/_jsx(HeadShake,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"Box\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Speech Recognition Not Supported :( \"}),/*#__PURE__*/_jsx(\"p\",{children:\"I won't be able to hear you on this browser.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Please try Chrome or Edge. :-)\"})]})})});//Show if using Chrome or Edge\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"PopoverButtons\",children:[\" \",/*#__PURE__*/_jsx(PopoverButtons,{}),\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"LetterAndHeart\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"GlowLetter\",children:[\" \",/*#__PURE__*/_jsx(YourLetter,{letter:letter}),\" \"]}),/*#__PURE__*/_jsx(\"div\",{className:\"Heart\",children:playingNow&&/*#__PURE__*/_jsx(HeartBar,{currentScore:tally,maxScore:5,size:50})})]}),/*#__PURE__*/_jsx(Confetti,{active:confettiSwitch,config:confettiConfig}),/*#__PURE__*/_jsx(RubberBand,{children:/*#__PURE__*/_jsx(\"div\",{className:\"Button\",children:/*#__PURE__*/_jsx(ReactiveButton,{state:current,onClick:function onClick(){handleClick();}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"Subtitles\",children:[/*#__PURE__*/_jsx(YourSubtitles,{state:current}),/*#__PURE__*/_jsx(UserSubtitles,{state:current})]})]})]});};//COMPONENT: Displaying input of voice interface (ie, recResult)\nvar YourSubtitles=function YourSubtitles(props){// Player's speech-- only displays when recResult!=undefined \nvar tally=props.state.context.tally;var recResult=props.state.context.recResult;//Prefix face changes based on score of the game\nvar emojis=['üòó','üôÇ','üòÄ','üòÑ','üòÅ','ü•≥'];var emoji=tally?emojis[tally]:'üôÉ';var subtitlesText;if(props.state.matches({asrtts:'recognising'})){subtitlesText=emoji+' Listening...';}else if(recResult&&recResult!=''){subtitlesText=emoji+' '+recResult;}else{subtitlesText='';}var _useWindupString3=useWindupString(subtitlesText),_useWindupString4=_slicedToArray(_useWindupString3,1),textAnimated=_useWindupString4[0];return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{children:[\" \",textAnimated,\" \"]})});};//This one doesn't show on Github pages...? but can run locally and use for presentation demo\nvar UserSubtitles=function UserSubtitles(props){var tally=props.state.context.tally;var recResult=props.state.context.recResult;// const recResult='testing text'\nvar emojis=['üòó','üôÇ','üòÄ','üòÑ','üòÅ','ü•≥'];var emoji=tally?emojis[tally]:'üôÉ';// const defaultText = props.state.matches({ asrtts: 'recognising' })? 'Listening...' : ''\n// const subtitlesText = recResult? recResult : defaultText\nvar subtitlesText;if(props.state.matches({asrtts:'recognising'})){subtitlesText='Listening...';}else if(recResult&&recResult!=''){subtitlesText=recResult;}else{subtitlesText='';}var _useWindupString5=useWindupString(subtitlesText),_useWindupString6=_slicedToArray(_useWindupString5,1),textAnimated=_useWindupString6[0];var showing=subtitlesText!='';return/*#__PURE__*/_jsxs(\"div\",{id:\"emoji-and-bubble\",children:[showing&&/*#__PURE__*/_jsxs(\"span\",{className:\"speech-bubble\",children:[\" \",textAnimated,\" \"]}),showing&&/*#__PURE__*/_jsxs(\"div\",{id:\"emoji\",children:[\" \",emoji,\" \"]})]});};//COMPONENT: Capital letter of the game\nvar YourLetter=function YourLetter(props){// Shows the letter of the current game round \nvar letter=props.letter;return/*#__PURE__*/_jsx(\"div\",{children:letter?letter.toUpperCase():''});};//COMPONENT: Grey heart to be filled with pink, based on percentage\nvar HeartBar=function HeartBar(props){var maxScore=props.maxScore;var currentScore=props.currentScore>0?props.currentScore:'';var size=props.size;var percentage=currentScore?100*currentScore/maxScore:0;//add other props? eg, showScore={true/false}; showPercentage={true/false}\nvar y=24-24*percentage/100;//Height of the pink filling shape\n//Below: Heart-shaped vector graphs & text inside\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"ProgressBarH\",children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:size,height:size,viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsxs(\"defs\",{children:[/*#__PURE__*/_jsx(\"clipPath\",{id:\"cut-off-bottom\",children:/*#__PURE__*/_jsx(\"rect\",{x:\"0\",y:y,width:\"24\",height:\"24\"})}),/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"grey-grad\",x1:\"0%\",y1:\"0%\",x2:\"0%\",y2:\"100%\",children:[/*#__PURE__*/_jsx(\"stop\",{offset:\"0%\",stopColor:\"#cfccce\",stopOpacity:\"0.75\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"60%\",stopColor:\"#bab8ba\",stopOpacity:\"0.85\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"100%\",stopColor:\"#949293\",stopOpacity:\"0.9\"})]}),/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"pink-grad\",x1:\"0%\",y1:\"0%\",x2:\"0%\",y2:\"100%\",children:[/*#__PURE__*/_jsx(\"stop\",{offset:\"0%\",stopColor:\"#ff33a7\",stopOpacity:\"0.95\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"60%\",stopColor:\"#ff2667\",stopOpacity:\"0.95\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"100%\",stopColor:\"rgb(255,0,0)\",stopOpacity:\"0.95\"})]})]}),/*#__PURE__*/_jsx(\"path\",{style:{fill:\"url(#grey-grad)\"},d:\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"}),/*#__PURE__*/_jsx(\"path\",{style:{fill:\"url(#pink-grad)\"},d:\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\",clipPath:\"url(#cut-off-bottom)\"}),/*#__PURE__*/_jsx(\"text\",{textAnchor:\"middle\",x:\"12\",y:\"15\",color:\"white\",fontSize:\"11\",fill:\"white\",opacity:\"0.45\",style:{animation:\"wiggle 2.5s ease-out infinite\",animationDelay:'0.9s'},children:currentScore})]})});};var PopoverButtons=function PopoverButtons(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Tippy,{content:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Having troubles playing? :\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Due to limitations of the voice recogniser, these might help... \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"-Speak in a North American accent.\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"-After the cat finishes talking, wait for a sec for it to start listening to you (indicated by the \",/*#__PURE__*/_jsx(\"strong\",{children:\"flashing button\"}),\").\"]})]}),className:\"popover-box\",children:/*#__PURE__*/_jsx(\"button\",{className:\"round-button\",children:\"?\"})}),/*#__PURE__*/_jsx(Tippy,{content:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"ABC Game\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Designed & made by: \",/*#__PURE__*/_jsx(\"br\",{}),\"Liao Hsien-hao Calvin\",/*#__PURE__*/_jsx(\"br\",{}),\"Eirini Tsakiri \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"for the project of \",/*#__PURE__*/_jsx(\"strong\",{children:\"LT2216 Dialogue Systems\"}),\" at G\\xF6teborgs universitet.\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"github.com/chickenbror/ABCgame\"]})]}),className:\"popover-box\",children:/*#__PURE__*/_jsx(\"button\",{className:\"round-button\",children:\"i\"})})]});};","map":{"version":3,"sources":["/Users/irene/Desktop/ABCgame/src/App.tsx"],"names":["React","Machine","assign","send","useMachine","asEffect","dmMachine","Confetti","TextLoop","useWindupString","HeadShake","require","RubberBand","Tippy","isChrome","isEdge","useSpeechSynthesis","useSpeechRecognition","machine","id","type","states","dm","asrtts","initial","idle","on","LISTEN","SPEAK","target","actions","_context","event","ttsAgenda","value","recognising","entry","exit","ASRRESULT","recResult","RECOGNISED","progress","match","speaking","ENDSPEECH","recLogResult","context","console","log","test","logIntent","nluData","intent","name","ReactiveButton","props","playingNow","state","maxHinted","hinted","maxSkipped","skipped","promptInGame","speakingText","promptMsg","matches","animation","stiffness","damping","spokentext","App","onEnd","speak","cancel","voices","onResult","result","listen","listening","stop","useState","voiceIndex","setVoiceIndex","devTools","recStart","interimResults","continuous","lang","recStop","ttsStart","effect","text","ttsCancel","current","service","confettiSwitch","tally","letter","confettiConfig","angle","spread","startVelocity","elementCount","dragFriction","duration","stagger","width","height","perspective","colors","clicked","handleClick","YourSubtitles","emojis","emoji","subtitlesText","textAnimated","UserSubtitles","showing","YourLetter","toUpperCase","HeartBar","maxScore","currentScore","size","percentage","y","fill","animationDelay","PopoverButtons"],"mappings":"qSAAA,MAAO,GAAKA,CAAAA,KAAZ,KAAuB,OAAvB,CAEA;AACA,OAASC,OAAT,CAAkBC,MAAlB,CAA0BC,IAA1B,KAA6C,QAA7C,CACA,OAASC,UAAT,CAAqBC,QAArB,KAAqC,eAArC,CACA,OAASC,SAAT,KAA0B,UAA1B,CAGA;AACA,MAAOC,CAAAA,QAAP,KAAqB,oBAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,iBAArB,CACA,OAASC,eAAT,KAAgC,SAAhC,CACQ;AACR,GAAMC,CAAAA,SAAS,CAAGC,OAAO,CAAC,wBAAD,CAAzB,CAAqD;AACrD,GAAMC,CAAAA,UAAU,CAAGD,OAAO,CAAC,yBAAD,CAA1B,CAEA,MAAOE,CAAAA,KAAP,KAAkB,gBAAlB,CACA;AAIA;AACA,OAASC,QAAT,CAAmBC,MAAnB,KAAiC,qBAAjC,CAGA;AACA;AAGA;AACA,OAASC,kBAAT,CAA6BC,oBAA7B,KAAyD,kBAAzD,C,wFAGA,GAAMC,CAAAA,OAAO,CAAGjB,OAAO,CAA4B,CAC/CkB,EAAE,CAAE,MAD2C,CAE/CC,IAAI,CAAE,UAFyC,CAG/CC,MAAM,CAAE,CACJC,EAAE,kBACKhB,SADL,CADE,CAIJiB,MAAM,CAAE,CACJC,OAAO,CAAE,MADL,CAEJH,MAAM,CAAE,CACJI,IAAI,CAAE,CACFC,EAAE,CAAE,CACAC,MAAM,CAAE,aADR,CAEAC,KAAK,CAAE,CACHC,MAAM,CAAE,UADL,CAEHC,OAAO,CAAE5B,MAAM,CAAC,SAAC6B,QAAD,CAAWC,KAAX,CAAqB,CAAE,MAAO,CAAEC,SAAS,CAAED,KAAK,CAACE,KAAnB,CAAP,CAAmC,CAA3D,CAFZ,CAFP,CADF,CADF,CAUJC,WAAW,CAAE,CACTX,OAAO,CAAE,UADA,CAETY,KAAK,CAAE,UAFE,CAGTC,IAAI,CAAE,SAHG,CAITX,EAAE,CAAE,CACAY,SAAS,CAAE,CACPR,OAAO,CAAE,CAAC,cAAD,CACL5B,MAAM,CAAC,SAAC6B,QAAD,CAAWC,KAAX,CAAqB,CAAE,MAAO,CAAEO,SAAS,CAAEP,KAAK,CAACE,KAAnB,CAAP,CAAmC,CAA3D,CADD,CADF,CAGPL,MAAM,CAAE,QAHD,CADX,CAMAW,UAAU,CAAE,MANZ,CAJK,CAYTnB,MAAM,CAAE,CACJoB,QAAQ,CAAE,EADN,CAGJC,KAAK,CAAE,CACHN,KAAK,CAAEjC,IAAI,CAAC,YAAD,CADR,CAHH,CAZC,CAVT,CA8BJwC,QAAQ,CAAE,CACNP,KAAK,CAAE,UADD,CAENV,EAAE,CAAE,CACAkB,SAAS,CAAE,MADX,CAFE,CA9BN,CAFJ,CAJJ,CAHuC,CAA5B,CAiDnB,CACId,OAAO,CAAE,CACLe,YAAY,CAAE,sBAACC,OAAD,CAAyB,CACnC,0CACAC,OAAO,CAACC,GAAR,CAAY,WAAaF,OAAO,CAACP,SAAjC,EAEH,CALI,CAMLU,IAAI,CAAE,eAAM,CACRF,OAAO,CAACC,GAAR,CAAY,MAAZ,EACH,CARI,CASLE,SAAS,CAAE,mBAACJ,OAAD,CAAyB,CAChC,kCACAC,OAAO,CAACC,GAAR,CAAY,kBAAoBF,OAAO,CAACK,OAAR,CAAgBC,MAAhB,CAAuBC,IAAvD,EACH,CAZI,CADb,CAjDmB,CAAvB,CAuEA;AACA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,KAAD,CAAgC,IAC5CC,CAAAA,UAD4C,CAC9BD,KAAK,CAACE,KAAN,CAAYX,OADkB,CAC5CU,UAD4C,IAE5CvB,CAAAA,SAF4C,CAE/BsB,KAAK,CAACE,KAAN,CAAYX,OAFmB,CAE5Cb,SAF4C,CAInD,GAAMyB,CAAAA,SAAS,CAAGH,KAAK,CAACE,KAAN,CAAYX,OAAZ,CAAoBa,MAApB,EAA8B,CAAhD,CACH,GAAMC,CAAAA,UAAU,CAAGL,KAAK,CAACE,KAAN,CAAYX,OAAZ,CAAoBe,OAApB,EAA+B,CAAlD,CAEG,GAAIC,CAAAA,YAAJ,CACA,GAAGF,UAAU,EAAIF,SAAjB,CAA2B,CAACI,YAAY,CAAG,yBAAf,CAAyC,CAArE,IACK,IAAGF,UAAU,EAAI,CAACF,SAAlB,CAA4B,CAACI,YAAY,CAAG,+BAAf,CAA+C,CAA5E,IACA,IAAG,CAACF,UAAD,EAAeF,SAAlB,CAA4B,CAACI,YAAY,CAAG,+BAAf,CAA+C,CAA5E,IACA,CAACA,YAAY,CAAG,qCAAf,CAAqD,CAAE;AAE7D,GAAIC,CAAAA,YAAY,CAAEP,UAAU,CAAE,MAAMvB,SAAR,CAAoB,MAAMA,SAAtD,CACA,GAAI+B,CAAAA,SAAS,CAAGR,UAAU,CAAEM,YAAF,CAAiB,kBAA3C,CAEA,OAAQ,IAAR,EACI,IAAKP,CAAAA,KAAK,CAACE,KAAN,CAAYQ,OAAZ,CAAoB,CAAE1C,MAAM,CAAE,aAAV,CAApB,CAAL,CACI,mBACI,2CAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,eAAhC,CACI,KAAK,CAAE,CAAE2C,SAAS,CAAE,oBAAb,CADX,EACmDX,KADnD,4BAII,MAAC,QAAD,EAAU,IAAI,CAAE,IAAhB,CAAsB,QAAQ,CAAE,IAAhC,CAAsC,YAAY,CAAE,CAAEY,SAAS,CAAE,GAAb,CAAkBC,OAAO,CAAE,CAA3B,CAApD,wBACI,kCAAK,4BAAQL,YAAR,OAAL,EADJ,cAEI,kCAAK,4BAAQC,SAAR,OAAL,EAFJ,GAJJ,GADJ,CAYJ,IAAKT,CAAAA,KAAK,CAACE,KAAN,CAAYQ,OAAZ,CAAoB,CAAE1C,MAAM,CAAE,UAAV,CAApB,CAAL,sBAEyBd,eAAe,CAACsD,YAAD,CAFxC,sDAEWM,UAFX,sBAEwD;AACpD,mBACI,2CAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,eAAhC,CACI,KAAK,CAAE,CAAEH,SAAS,CAAE,uBAAb,CADX,EACuDX,KADvD,4BAGI,sBAAOc,UAAP,EAHJ,GADJ,CAOJ,QACI,mBACI,2CAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,eAAhC,EAAoDd,KAApD,4BACI,KAAC,SAAD,yBADJ,GADJ,CAzBR,CA+BH,CA/CD,CAiDA;AACA,cAAe,SAASe,CAAAA,GAAT,EAAe,CAE1B;AACA;AAH0B,wBAIkBtD,kBAAkB,CAAC,CAC3DuD,KAAK,CAAE,gBAAM,CAACpE,IAAI,CAAC,WAAD,CAAJ,CAAmB,CAD0B,CAAD,CAJpC,CAIlBqE,KAJkB,qBAIlBA,KAJkB,CAIXC,MAJW,qBAIXA,MAJW,CAIH9B,QAJG,qBAIHA,QAJG,CAIO+B,MAJP,qBAIOA,MAJP,CAQ1B;AAR0B,0BASUzD,oBAAoB,CAAC,CACrD0D,QAAQ,CAAE,kBAACC,MAAD,CAAiB,CAACzE,IAAI,CAAC,CAAEiB,IAAI,CAAE,WAAR,CAAqBc,KAAK,CAAE0C,MAA5B,CAAD,CAAJ,CAA6C,CADpB,CAAD,CAT9B,CASlBC,MATkB,uBASlBA,MATkB,CASVC,SATU,uBASVA,SATU,CASCC,IATD,uBASCA,IATD,CAa1B;AAb0B,oBAcU/E,KAAK,CAACgF,QAAN,CAAe,IAAf,CAdV,oDAcnBC,UAdmB,qBAcPC,aAdO,qBAe1B;AACA;AAhB0B,gBAkBO9E,UAAU,CAACc,OAAD,CAAU,CACjDiE,QAAQ,CAAE,IADuC,CAEjDrD,OAAO,CAAE,CACLsD,QAAQ,CAAE/E,QAAQ,CAAC,UAAM,CACrB0C,OAAO,CAACC,GAAR,CAAY,iCAAZ,EACA6B,MAAM,CAAC,CACHQ,cAAc,CAAE,KADb,CAEHC,UAAU,CAAE,IAFT,CAGHC,IAAI,CAAE,OAAS;AAHZ,CAAD,CAAN,CAKH,CAPiB,CADb,CASLC,OAAO,CAAEnF,QAAQ,CAAC,UAAM,CACpB0C,OAAO,CAACC,GAAR,CAAY,sBAAZ,EACA+B,IAAI,GACP,CAHgB,CATZ,CAaLU,QAAQ,CAAEpF,QAAQ,CAAC,SAACyC,OAAD,CAAU4C,MAAV,CAAqB,CACpC3C,OAAO,CAACC,GAAR,CAAY,aAAZ,EACAwB,KAAK,CAAC,CAAEmB,IAAI,CAAE7C,OAAO,CAACb,SACd,WADF,CACc;AADd,CAAD,CAAL,CAGH,CALiB,CAbb,CAmBL2D,SAAS,CAAEvF,QAAQ,CAAC,SAACyC,OAAD,CAAU4C,MAAV,CAAqB,CACrC3C,OAAO,CAACC,GAAR,CAAY,aAAZ,EACAyB,MAAM,GACT,CAHkB,CAnBd,CAuBLD,KAAK,CAAEnE,QAAQ,CAAC,SAACyC,OAAD,CAAa,CAC5BC,OAAO,CAACC,GAAR,CAAY,aAAZ,EACGwB,KAAK,CAAC,CAACmB,IAAI,CAAE7C,OAAO,CAACb,SAAf,CAAD,CAAL,CACH,CAHc,CAvBV,CAFwC,CAAV,CAlBjB,4CAkBnB4D,OAlBmB,iBAkBV1F,IAlBU,iBAkBJ2F,OAlBI,iBAkD1B;AAlD0B,GAmDlBC,CAAAA,cAnDkB,CAmDCF,OAAO,CAAC/C,OAnDT,CAmDlBiD,cAnDkB,CAmDkB;AAnDlB,GAoDlBvC,CAAAA,UApDkB,CAoDHqC,OAAO,CAAC/C,OApDL,CAoDlBU,UApDkB,IAqDlBwC,CAAAA,KArDkB,CAqDRH,OAAO,CAAC/C,OArDA,CAqDlBkD,KArDkB,IAsDlBC,CAAAA,MAtDkB,CAsDPJ,OAAO,CAAC/C,OAtDD,CAsDlBmD,MAtDkB,CAwD1B;AACA,GAAMC,CAAAA,cAAc,CAAG,CACnBC,KAAK,CAAE,EADY,CAEnBC,MAAM,CAAE,GAFW,CAGnBC,aAAa,CAAE,EAHI,CAInBC,YAAY,CAAE,GAJK,CAKnBC,YAAY,CAAE,IALK,CAMnBC,QAAQ,CAAE,IANS,CAOnBC,OAAO,CAAE,CAPU,CAQnBC,KAAK,CAAE,KARY,CASnBC,MAAM,CAAE,KATW,CAUnBC,WAAW,CAAE,OAVM,CAWnBC,MAAM,CAAE,CAAC,SAAD,CAAY,SAAZ,CAAuB,SAAvB,CAAkC,SAAlC,CAA6C,SAA7C,CAXW,CAAvB,CAcA,GAAIC,CAAAA,OAAO,CAAC,CAAZ,CACA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAK,CACrB,GAAGD,OAAO,GAAG,CAAb,CAAe,CAAE/D,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAwB7C,IAAI,CAAC,OAAD,CAAJ,CAAe2G,OAAO,CAAC,CAAR,CAAW,CAAnE,IACI,CAAE/D,OAAO,CAACC,GAAR,CAAY,WAAZ,EAA0B7C,IAAI,CAAC,SAAD,CAAJ,CAAiB2G,OAAO,CAAC,CAAR,CAAW,CAC/D,CAHD,CAKA;AAEA;AACA,GAAG,CAAChG,QAAD,EAAa,CAACC,MAAjB,CACA,mBACI,YAAK,SAAS,CAAC,eAAf,uBACI,KAAC,SAAD,wBACA,aAAK,SAAS,CAAC,KAAf,wBACI,4DADJ,cAEI,mEAFJ,cAGI,qDAHJ,GADA,EADJ,EADJ,CAYA;AACA,mBACI,aAAK,SAAS,CAAC,MAAf,wBACI,aAAK,SAAS,CAAC,gBAAf,4BAAiC,KAAC,cAAD,IAAjC,OADJ,cAEI,aAAK,SAAS,CAAC,KAAf,wBAEI,aAAK,SAAS,CAAC,gBAAf,wBACI,aAAK,SAAS,CAAC,YAAf,4BAA6B,KAAC,UAAD,EAAY,MAAM,CAAEkF,MAApB,EAA7B,OADJ,cAEI,YAAK,SAAS,CAAC,OAAf,UACKzC,UAAU,eAAI,KAAC,QAAD,EAAU,YAAY,CAAEwC,KAAxB,CAA+B,QAAQ,CAAE,CAAzC,CAA4C,IAAI,CAAE,EAAlD,EADnB,EAFJ,GAFJ,cASI,KAAC,QAAD,EAAU,MAAM,CAAGD,cAAnB,CAAoC,MAAM,CAAGG,cAA7C,EATJ,cAWI,KAAC,UAAD,wBACI,YAAK,SAAS,CAAC,QAAf,uBACI,KAAC,cAAD,EAAgB,KAAK,CAAEL,OAAvB,CAAgC,OAAO,CAAE,kBAAM,CAACkB,WAAW,GAAG,CAA9D,EADJ,EADJ,EAXJ,cAiBI,aAAK,SAAS,CAAC,WAAf,wBAEI,KAAC,aAAD,EAAe,KAAK,CAAElB,OAAtB,EAFJ,cAKI,KAAC,aAAD,EAAe,KAAK,CAAEA,OAAtB,EALJ,GAjBJ,GAFJ,GADJ,CAgCH,EAED;AACA,GAAMmB,CAAAA,aAAa,CAAC,QAAdA,CAAAA,aAAc,CAACzD,KAAD,CAAgB,CAChC;AADgC,GAGzByC,CAAAA,KAHyB,CAGhBzC,KAAK,CAACE,KAAN,CAAYX,OAHI,CAGzBkD,KAHyB,IAIzBzD,CAAAA,SAJyB,CAIZgB,KAAK,CAACE,KAAN,CAAYX,OAJA,CAIzBP,SAJyB,CAKhC;AACA,GAAO0E,CAAAA,MAAM,CAAC,CAAC,IAAD,CAAM,IAAN,CAAW,IAAX,CAAgB,IAAhB,CAAqB,IAArB,CAA0B,IAA1B,CAAd,CACA,GAAIC,CAAAA,KAAK,CAAClB,KAAK,CAAEiB,MAAM,CAACjB,KAAD,CAAR,CAAgB,IAA/B,CAEA,GAAImB,CAAAA,aAAJ,CACA,GAAG5D,KAAK,CAACE,KAAN,CAAYQ,OAAZ,CAAoB,CAAE1C,MAAM,CAAE,aAAV,CAApB,CAAH,CAAkD,CAC9C4F,aAAa,CAACD,KAAK,CAAC,eAApB,CACH,CAFD,IAEM,IAAG3E,SAAS,EAAIA,SAAS,EAAE,EAA3B,CAA8B,CAChC4E,aAAa,CAAGD,KAAK,CAAC,GAAN,CAAU3E,SAA1B,CACH,CAFK,IAED,CACD4E,aAAa,CAAG,EAAhB,CACH,CAhB+B,sBAkBT1G,eAAe,CAAC0G,aAAD,CAlBN,uDAkBzBC,YAlByB,sBAmBhC,mBACI,kCACI,4BAAQA,YAAR,OADJ,EADJ,CAKH,CAxBD,CA0BA;AACA,GAAMC,CAAAA,aAAa,CAAC,QAAdA,CAAAA,aAAc,CAAC9D,KAAD,CAAgB,IAEzByC,CAAAA,KAFyB,CAEhBzC,KAAK,CAACE,KAAN,CAAYX,OAFI,CAEzBkD,KAFyB,IAGzBzD,CAAAA,SAHyB,CAGZgB,KAAK,CAACE,KAAN,CAAYX,OAHA,CAGzBP,SAHyB,CAIhC;AAEA,GAAO0E,CAAAA,MAAM,CAAC,CAAC,IAAD,CAAM,IAAN,CAAW,IAAX,CAAgB,IAAhB,CAAqB,IAArB,CAA0B,IAA1B,CAAd,CACA,GAAIC,CAAAA,KAAK,CAAElB,KAAK,CAAEiB,MAAM,CAACjB,KAAD,CAAR,CAAgB,IAAhC,CAEA;AACA;AAEA,GAAImB,CAAAA,aAAJ,CACA,GAAG5D,KAAK,CAACE,KAAN,CAAYQ,OAAZ,CAAoB,CAAE1C,MAAM,CAAE,aAAV,CAApB,CAAH,CAAkD,CAC9C4F,aAAa,CAAC,cAAd,CACH,CAFD,IAEM,IAAG5E,SAAS,EAAIA,SAAS,EAAE,EAA3B,CAA8B,CAChC4E,aAAa,CAAG5E,SAAhB,CACH,CAFK,IAED,CACD4E,aAAa,CAAG,EAAhB,CACH,CAnB+B,sBAqBT1G,eAAe,CAAC0G,aAAD,CArBN,uDAqBzBC,YArByB,sBAsBhC,GAAME,CAAAA,OAAO,CAAGH,aAAa,EAAE,EAA/B,CACA,mBACI,aAAK,EAAE,CAAC,kBAAR,WACKG,OAAO,eAAK,cAAM,SAAS,CAAC,eAAhB,eAAkCF,YAAlC,OADjB,CAEKE,OAAO,eAAI,aAAK,EAAE,CAAC,OAAR,eAAkBJ,KAAlB,OAFhB,GADJ,CAMH,CA7BD,CA+BA;AACA,GAAMK,CAAAA,UAAU,CAAC,QAAXA,CAAAA,UAAW,CAAChE,KAAD,CAAc,CAC3B;AACA,GAAM0C,CAAAA,MAAM,CAAG1C,KAAK,CAAC0C,MAArB,CACA,mBACI,qBACKA,MAAM,CAAEA,MAAM,CAACuB,WAAP,EAAF,CAAuB,EADlC,EADJ,CAKH,CARD,CAUA;AACA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAClE,KAAD,CAAe,CAE5B,GAAMmE,CAAAA,QAAQ,CAAGnE,KAAK,CAACmE,QAAvB,CACA,GAAMC,CAAAA,YAAY,CAAGpE,KAAK,CAACoE,YAAN,CAAmB,CAAnB,CAAsBpE,KAAK,CAACoE,YAA5B,CAA2C,EAAhE,CACA,GAAMC,CAAAA,IAAI,CAAGrE,KAAK,CAACqE,IAAnB,CACA,GAAMC,CAAAA,UAAU,CAAGF,YAAY,CAAE,IAAIA,YAAJ,CAAiBD,QAAnB,CAA8B,CAA7D,CACA;AAGA,GAAMI,CAAAA,CAAC,CAAG,GAAM,GAAKD,UAAN,CAAoB,GAAnC,CAAwC;AAExC;AACA,mBACE,YAAK,SAAS,CAAC,cAAf,uBACE,aACE,KAAK,CAAC,4BADR,CAEE,KAAK,CAAED,IAFT,CAGE,MAAM,CAAEA,IAHV,CAIE,OAAO,CAAC,WAJV,wBAME,qCACE,iBAAU,EAAE,CAAC,gBAAb,uBACE,aAAM,CAAC,CAAC,GAAR,CAAY,CAAC,CAAEE,CAAf,CAAkB,KAAK,CAAC,IAAxB,CAA6B,MAAM,CAAC,IAApC,EADF,EADF,cAKE,wBAAgB,EAAE,CAAC,WAAnB,CAA+B,EAAE,CAAC,IAAlC,CAAuC,EAAE,CAAC,IAA1C,CAA+C,EAAE,CAAC,IAAlD,CAAuD,EAAE,CAAC,MAA1D,wBACI,aAAM,MAAM,CAAC,IAAb,CAAkB,SAAS,CAAC,SAA5B,CAAsC,WAAW,CAAC,MAAlD,EADJ,cAEI,aAAM,MAAM,CAAC,KAAb,CAAmB,SAAS,CAAC,SAA7B,CAAuC,WAAW,CAAC,MAAnD,EAFJ,cAGI,aAAM,MAAM,CAAC,MAAb,CAAoB,SAAS,CAAC,SAA9B,CAAwC,WAAW,CAAC,KAApD,EAHJ,GALF,cAWE,wBAAgB,EAAE,CAAC,WAAnB,CAA+B,EAAE,CAAC,IAAlC,CAAuC,EAAE,CAAC,IAA1C,CAA+C,EAAE,CAAC,IAAlD,CAAuD,EAAE,CAAC,MAA1D,wBACI,aAAM,MAAM,CAAC,IAAb,CAAkB,SAAS,CAAC,SAA5B,CAAsC,WAAW,CAAC,MAAlD,EADJ,cAEI,aAAM,MAAM,CAAC,KAAb,CAAmB,SAAS,CAAC,SAA7B,CAAuC,WAAW,CAAC,MAAnD,EAFJ,cAGI,aAAM,MAAM,CAAC,MAAb,CAAoB,SAAS,CAAC,cAA9B,CAA6C,WAAW,CAAC,MAAzD,EAHJ,GAXF,GANF,cAyBE,aACE,KAAK,CAAE,CAAEC,IAAI,CAAE,iBAAR,CADT,CAEE,CAAC,CAAC,qIAFJ,EAzBF,cA8BE,aACE,KAAK,CAAE,CAAEA,IAAI,CAAE,iBAAR,CADT,CAEE,CAAC,CAAC,qIAFJ,CAGE,QAAQ,CAAC,sBAHX,EA9BF,cAoCE,aAAM,UAAU,CAAC,QAAjB,CAA0B,CAAC,CAAC,IAA5B,CAAiC,CAAC,CAAC,IAAnC,CAAwC,KAAK,CAAC,OAA9C,CAAsD,QAAQ,CAAC,IAA/D,CAAoE,IAAI,CAAC,OAAzE,CAAiF,OAAO,CAAC,MAAzF,CACM,KAAK,CAAE,CAAC7D,SAAS,CAAE,+BAAZ,CAA6C8D,cAAc,CAAC,MAA5D,CADb,UAEGL,YAFH,EApCF,GADF,EADF,CA8CD,CA1DH,CA4DA,GAAMM,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAGzB,mBACI,oCAEI,KAAC,KAAD,EAAO,OAAO,cACV,oCACA,kDADA,cAGI,qGACgE,aADhE,cACyE,aADzE,mDAEkC,aAFlC,cAE2C,aAF3C,oHAIkB,2CAJlB,QAHJ,GADJ,CAWE,SAAS,CAAC,aAXZ,uBAYI,eAAQ,SAAS,CAAC,cAAlB,eAZJ,EAFJ,cAiBI,KAAC,KAAD,EAAO,OAAO,cACN,oCACA,gCADA,cAEI,yDACoB,aADpB,sCAEqB,aAFrB,gCAGe,aAHf,cAGwB,aAHxB,oCAImB,mDAJnB,8CAKA,aALA,cAKS,aALT,oCAFJ,GADR,CAYG,SAAS,CAAC,aAZb,uBAaI,eAAQ,SAAS,CAAC,cAAlB,eAbJ,EAjBJ,GADJ,CAqCH,CAxCD","sourcesContent":["import * as React from \"react\";\n\n//XState library & Game DM-machine\nimport { Machine, assign, send, State } from \"xstate\";\nimport { useMachine, asEffect } from \"@xstate/react\";\nimport { dmMachine } from './dmGame';\n\n\n//Animation effects\nimport Confetti from 'react-dom-confetti';\nimport TextLoop from \"react-text-loop\";\nimport { useWindupString } from \"windups\";\n        // import HeadShake from 'react-reveal/HeadShake';\nconst HeadShake = require('react-reveal/HeadShake'); //?import shows error in TS, so use require() here instead\nconst RubberBand = require('react-reveal/RubberBand');\n\nimport Tippy from '@tippyjs/react';\n// import 'tippy.js/dist/tippy.css'; \n\n\n\n//Browser detection \nimport { isChrome, isEdge } from \"react-device-detect\";\n\n\n// import { inspect } from \"@xstate/inspect\";\n// inspect({ url:\"https://statecharts.io/inspect\", iframe: false });\n\n\n// State machines: ASR-TTS (voice interface) & dmGame\nimport { useSpeechSynthesis, useSpeechRecognition } from 'react-speech-kit';\n\n\nconst machine = Machine<SDSContext, any, SDSEvent>({\n    id: 'root',\n    type: 'parallel',\n    states: {\n        dm: {\n            ...dmMachine  //dmGame\n        },\n        asrtts: {\n            initial: 'idle',\n            states: {\n                idle: {\n                    on: {\n                        LISTEN: 'recognising',\n                        SPEAK: {\n                            target: 'speaking',\n                            actions: assign((_context, event) => { return { ttsAgenda: event.value } })\n                        }\n                    }\n                },\n                recognising: {\n                    initial: 'progress',\n                    entry: 'recStart',\n                    exit: 'recStop',\n                    on: {\n                        ASRRESULT: {\n                            actions: ['recLogResult',\n                                assign((_context, event) => { return { recResult: event.value } })],\n                            target: '.match'\n                        },\n                        RECOGNISED: 'idle'\n                    },\n                    states: {\n                        progress: {\n                        },\n                        match: {\n                            entry: send('RECOGNISED'),\n                        },\n                    }\n                },\n                speaking: {\n                    entry: 'ttsStart',\n                    on: {\n                        ENDSPEECH: 'idle',\n                    }\n                }\n            }\n        }\n    },\n},\n    {\n        actions: {\n            recLogResult: (context: SDSContext) => {\n                /* context.recResult = event.recResult; */\n                console.log('<< ASR: ' + context.recResult);\n\n            },\n            test: () => {\n                console.log('test')\n            },\n            logIntent: (context: SDSContext) => {\n                /* context.nluData = event.data */\n                console.log('<< NLU intent: ' + context.nluData.intent.name)\n            }\n        },\n    });\n\n\n\ninterface Props extends React.HTMLAttributes<HTMLElement> {\n    state: State<SDSContext, any, any, any>;  //==dm context >>access via props.state.context\n}\n//COMPONENT: Big button in the middle, with changing texts\nconst ReactiveButton = (props: Props,): JSX.Element => {\n    const {playingNow} = props.state.context\n    const {ttsAgenda} = props.state.context\n\n    const maxHinted = props.state.context.hinted >= 5\n\tconst maxSkipped = props.state.context.skipped >= 5\n\n    let promptInGame:string;\n    if(maxSkipped && maxHinted){promptInGame = '...or say Restart, Stop'}\n    else if(maxSkipped && !maxHinted){promptInGame = '...or say Clue, Restart, Stop'}\n    else if(!maxSkipped && maxHinted){promptInGame = '...or say Skip, Restart, Stop'}\n    else {promptInGame = '...or say Clue, Skip, Restart, Stop'}  //default\n\n    let speakingText= playingNow? 'üòº '+ttsAgenda : 'üòª '+ttsAgenda\n    let promptMsg = playingNow? promptInGame : \"...say Yes or No\"\n\n    switch (true) {\n        case props.state.matches({ asrtts: 'recognising' }):\n            return (\n                <button type=\"button\" className=\"glow-on-hover\"\n                    style={{ animation: \"glowing 20s linear\"}} {...props}>\n                    {/* Listening... */}\n\n                    <TextLoop mask={true} interval={5000} springConfig={{ stiffness: 170, damping: 8 }} >\n                        <div><code> {speakingText} </code></div>\n                        <div><code> {promptMsg} </code></div>\n                    </TextLoop>\n\n                </button>\n            );\n        case props.state.matches({ asrtts: 'speaking' }):\n            \n            const [spokentext] = useWindupString(speakingText); // adds char-by-char animation\n            return (\n                <button type=\"button\" className=\"glow-on-hover\"\n                    style={{ animation: \"bordering 1s infinite\" }} {...props}>\n                    {/* Speaking... */}\n                    <code>{spokentext}</code>\n                </button>\n            );\n        default:\n            return (\n                <button type=\"button\" className=\"glow-on-hover\" {...props}>\n                    <HeadShake>Play game!</HeadShake>\n                </button >\n            );\n    }\n}\n\n// //MAIN CONTAINER: React webpage elements & VOI\nexport default function App() {\n    \n    //Voice interface events (& console logs)\n    //Text to speech:\n    const { speak, cancel, speaking, voices } = useSpeechSynthesis({\n        onEnd: () => {send('ENDSPEECH') },\n    });\n\n    //Speech to text\n    const { listen, listening, stop } = useSpeechRecognition({\n        onResult: (result: any) => {send({ type: \"ASRRESULT\", value: result })  },\n    });\n\n    //List the supported synthesis-voices on the browswer:\n    const [voiceIndex, setVoiceIndex] = React.useState(null);\n    // console.log(voices) //An array of available voices/languages ... varies depending on the computer/browser\n    // const voice =  voices[5] || null; // voices[idx]? voices[idx] : null *(browser default voice)\n\n    const [current, send, service] = useMachine(machine, {\n        devTools: true,\n        actions: {\n            recStart: asEffect(() => {\n                console.log('Ready to receive a voice input.');\n                listen({\n                    interimResults: false,\n                    continuous: true,\n                    lang: 'en-SG'  //Config recognition language here. //list of langs https://cloud.google.com/speech-to-text/docs/languages\n                });\n            }),\n            recStop: asEffect(() => {\n                console.log('Recognition stopped.');\n                stop()\n            }),\n            ttsStart: asEffect((context, effect) => {\n                console.log('Speaking...');\n                speak({ text: context.ttsAgenda\n                        /*, voice*/ //Config which language/voice to speak in\n                     }) \n            }),\n            ttsCancel: asEffect((context, effect) => {\n                console.log('TTS STOP...');\n                cancel()\n            }),\n            speak: asEffect((context) => {\n\t            console.log('Speaking...');\n                speak({text: context.ttsAgenda })\n            }) \n        }\n    });\n\n    // dmMachine-context / React-states, to display on webpage or turn components on/off\n    const { confettiSwitch } = current.context; //triggers confetti when true\n    const { playingNow } = current.context;\n    const { tally } = current.context;\n    const { letter } = current.context;\n    \n    // Config for confetti \n    const confettiConfig = {\n        angle: 90,\n        spread: 360,\n        startVelocity: 80,\n        elementCount: 400,\n        dragFriction: 0.12,\n        duration: 7500,\n        stagger: 1,\n        width: \"7px\",\n        height: \"7px\",\n        perspective: \"210px\",\n        colors: [\"#a864fd\", \"#29cdff\", \"#78ff44\", \"#ff718d\", \"#fdff6a\"]\n      };\n    \n    let clicked=0;\n    const handleClick = () =>{ \n        if(clicked===0){ console.log(\"clicked\"); send('CLICK'); clicked=1 }\n        else{ console.log(\"unclicked\"); send('UNCLICK'); clicked=0 }\n    }\n\n    //>>>JSX codes & various components\n    \n    // Alt page: Show if not using Chrome or Edge\n    if(!isChrome && !isEdge)\n    return (\n        <div className='OtherBrowsers'>  \n            <HeadShake>\n            <div className='Box'>   \n                <h1>Speech Recognition Not Supported :( </h1>\n                <p>I won't be able to hear you on this browser.</p>\n                <p>Please try Chrome or Edge. :-)</p>\n            </div>\n            </HeadShake>\n        </div>\n      )\n\n    //Show if using Chrome or Edge\n    return (\n        <div className='main'>\n            <div className=\"PopoverButtons\"> <PopoverButtons/> </div>\n            <div className=\"App\">\n                \n                <div className=\"LetterAndHeart\">\n                    <div className=\"GlowLetter\"> <YourLetter letter={letter}/> </div>\n                    <div className=\"Heart\"> \n                        {playingNow && <HeartBar currentScore={tally} maxScore={5} size={50} />  }\n                    </div> \n                </div>\n                \n                <Confetti active={ confettiSwitch } config={ confettiConfig }/> \n\n                <RubberBand>\n                    <div className=\"Button\"> \n                        <ReactiveButton state={current} onClick={() => {handleClick()}} /> \n                    </div>\n                </RubberBand>\n\n                <div className=\"Subtitles\"> \n                    {/* VersionA: FOR Github deployment & Canvas submission */}\n                    <YourSubtitles state={current}/> \n\n                    {/* Version B: FOR demo (on local cuz it cannot show on Github page) */}\n                    <UserSubtitles state={current}/> \n                </div>\n            \n            </div>\n\n        </div>\n    )\n};\n\n//COMPONENT: Displaying input of voice interface (ie, recResult)\nconst YourSubtitles=(props:Props) =>{\n    // Player's speech-- only displays when recResult!=undefined \n\n    const {tally} = props.state.context\n    const {recResult} = props.state.context\n    //Prefix face changes based on score of the game\n    const  emojis=['üòó','üôÇ','üòÄ','üòÑ','üòÅ','ü•≥']\n    let emoji=tally? emojis[tally]:'üôÉ'\n\n    let subtitlesText:string;\n    if(props.state.matches({ asrtts: 'recognising' })){\n        subtitlesText=emoji+' Listening...'\n    }else if(recResult && recResult!=''){\n        subtitlesText = emoji+' '+recResult\n    }else{\n        subtitlesText = ''\n    }\n\n    const [textAnimated] = useWindupString(subtitlesText);\n    return(\n        <div>\n            <span> {textAnimated} </span>\n        </div>\n    )\n}\n\n//This one doesn't show on Github pages...? but can run locally and use for presentation demo\nconst UserSubtitles=(props:Props) =>{\n\n    const {tally} = props.state.context\n    const {recResult} = props.state.context\n    // const recResult='testing text'\n\n    const  emojis=['üòó','üôÇ','üòÄ','üòÑ','üòÅ','ü•≥']\n    let emoji= tally? emojis[tally]:'üôÉ'\n\n    // const defaultText = props.state.matches({ asrtts: 'recognising' })? 'Listening...' : ''\n    // const subtitlesText = recResult? recResult : defaultText\n\n    let subtitlesText:string;\n    if(props.state.matches({ asrtts: 'recognising' })){\n        subtitlesText='Listening...'\n    }else if(recResult && recResult!=''){\n        subtitlesText = recResult\n    }else{\n        subtitlesText = ''\n    }\n\n    const [textAnimated] = useWindupString(subtitlesText);\n    const showing = subtitlesText!=''\n    return(\n        <div id='emoji-and-bubble'>\n            {showing &&  <span className='speech-bubble'> {textAnimated} </span> }\n            {showing && <div id='emoji'> {emoji} </div>}\n        </div>\n    )\n}\n\n//COMPONENT: Capital letter of the game\nconst YourLetter=(props:any) =>{\n    // Shows the letter of the current game round \n    const letter = props.letter\n    return(\n        <div> \n            {letter? letter.toUpperCase():''}\n        </div> \n    )\n}\n\n//COMPONENT: Grey heart to be filled with pink, based on percentage\nconst HeartBar = (props:any) => {\n    \n    const maxScore = props.maxScore\n    const currentScore = props.currentScore>0? props.currentScore : ''\n    const size = props.size\n    const percentage = currentScore? 100*currentScore/maxScore : 0\n    //add other props? eg, showScore={true/false}; showPercentage={true/false}\n\n\n    const y = 24 - (24 * percentage) / 100; //Height of the pink filling shape\n\n    //Below: Heart-shaped vector graphs & text inside\n    return (\n      <div className=\"ProgressBarH\">\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width={size}\n          height={size}\n          viewBox=\"0 0 24 24\"\n        >\n          <defs>\n            <clipPath id=\"cut-off-bottom\">\n              <rect x=\"0\" y={y} width=\"24\" height=\"24\" />\n            </clipPath>\n          \n            <linearGradient id=\"grey-grad\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                <stop offset=\"0%\" stopColor=\"#cfccce\" stopOpacity=\"0.75\" />\n                <stop offset=\"60%\" stopColor=\"#bab8ba\" stopOpacity=\"0.85\" />\n                <stop offset=\"100%\" stopColor=\"#949293\" stopOpacity=\"0.9\" />\n            </linearGradient>\n\n            <linearGradient id=\"pink-grad\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                <stop offset=\"0%\" stopColor=\"#ff33a7\" stopOpacity=\"0.95\" />\n                <stop offset=\"60%\" stopColor=\"#ff2667\" stopOpacity=\"0.95\" />\n                <stop offset=\"100%\" stopColor=\"rgb(255,0,0)\" stopOpacity=\"0.95\" />\n            </linearGradient>\n\n          </defs>\n          \n          <path\n            style={{ fill: \"url(#grey-grad)\" }}\n            d=\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"\n            />\n\n          <path\n            style={{ fill: \"url(#pink-grad)\", }}\n            d=\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"\n            clipPath=\"url(#cut-off-bottom)\"\n            />\n\n          <text textAnchor=\"middle\" x=\"12\" y=\"15\" color=\"white\" fontSize=\"11\" fill=\"white\" opacity=\"0.45\"\n                style={{animation: \"wiggle 2.5s ease-out infinite\", animationDelay:'0.9s'}}>\n            {currentScore} \n          </text>\n\n        </svg>\n      </div>\n    );\n  };\n\nconst PopoverButtons = () => {\n\n\n    return (\n        <div>\n\n            <Tippy content={\n                <div>\n                <h4>Having troubles playing? :</h4>\n            \n                    <p>\n                    Due to limitations of the voice recogniser, these might help... <br></br><br></br>\n                    -Speak in a North American accent.<br></br><br></br>\n                    -After the cat finishes talking, wait for a sec for it to start listening to you\n                    (indicated by the <strong>flashing button</strong>).\n                    </p>\n                </div>\n            } className=\"popover-box\">\n                <button className=\"round-button\">?</button>\n            </Tippy>\n\n            <Tippy content={\n                    <div>\n                    <h4>ABC Game</h4>\n                        <p>\n                        Designed & made by: <br></br>\n                        Liao Hsien-hao Calvin<br></br>\n                        Eirini Tsakiri <br></br><br></br>\n                        for the project of <strong>LT2216 Dialogue Systems</strong> at G√∂teborgs universitet.\n                        <br></br><br></br>\n                        github.com/chickenbror/ABCgame\n                        </p>\n                    </div>\n            }  className=\"popover-box\">\n                <button className=\"round-button\">i</button>\n            </Tippy>\n\n\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}